<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Add New Quiz</title>
    <link th:href="@{../vendor/bootstrap/bootstrap.min.css}" rel="stylesheet" />
    <link th:href="@{../css/main.css}" rel="stylesheet" />
    <link rel="icon" type="image/x-icon" th:href="@{/images/favicon.ico}" />
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</head>
<body>
<header th:insert="~{index.html :: header-navbar}" class="bg-light"></header>


    <div class="container-fluid col-md-4" style="padding-top: 30px">
        <h2>CREATE NEW QUIZ</h2>

        <form id="quizForm" class="justify-content-center" th:action="@{/quiz/create}" th:object="${quiz}" method="post" >
            <div class="mb-3">
                <label for="exampleFormControlInput1" class="form-label">Quiz Code</label>
                <input th:field="*{code}" type="text" class="form-control" id="exampleFormControlInput1" placeholder="Quiz Code"
                       style="align-content: center; width: 450px ">
            </div>
            <div class="mb-3">
                <label for="exampleFormControlInput1" class="form-label">Quiz Title</label>
                <input th:field="*{title}" type="text" class="form-control" id="exampleFormControlInput2" placeholder="Quiz Title"
                       style="align-content: center; width: 450px ">
            </div>
            <div class="mb-3">
                <label for="exampleFormControlTextarea1" class="form-label">Description</label>
                <textarea th:field="*{description}" class="form-control" id="exampleFormControlTextarea1" rows="3"
                          style="align-content: center; width: 450px "></textarea>
            </div>
            <div style="display:flex">
                <div class="form-check">
                    <input th:field="*{isExamOnly}" class="form-check-input" type="radio" name="is_exam_only" id="flexRadioDefault1" value="1">
                    <label class="form-check-label" for="flexRadioDefault1">
                        Exam Only
                    </label>
                </div>
                <div class="form-check">
                    <input th:field="*{isExamOnly}" class="form-check-input" type="radio" name="is_exam_only" id="flexRadioDefault2" value="0">
                    <label class="form-check-label" for="flexRadioDefault2">
                        Practice
                    </label>
                </div>
            </div>
            <div class="form-check">
                <input th:field="*{isActive}" class="form-check-input" type="checkbox" name="is_active" value="1" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                    Enable
                </label>
            </div>
                <button type="submit" class="btn btn-primary">Create</button>
        </form>
    </div>
</body>

<script th:inline="javascript">
    $(document).ready(function () {
        $("#quizForm").submit(function (event) {
            event.preventDefault();

            $.ajax({
                type: "POST",
                url: "/quiz/create",
                data: $("#quizForm").serialize(),
                success: function (data) {
                        $("#successMessage").text(data);
                        $(".toast-success").toast('show');
                        setTimeout(function(){
                            window.location.href = "/quiz";
                        }, 1500);
                    } ,
                error: function (xhr, status, error) {
                    var errorMessage = JSON.parse(xhr.responseText).errorMessage;
                    $("#errorMessage").text(errorMessage);
                    $(".toast-error").toast('show');
                }
            });
        });
    });
</script>
<!-- Toast cho thông báo thành công -->
<div class="toast toast-success" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false" style="position: absolute; top: 0; right: 0;">
    <div class="toast-header">
        <strong class="me-auto">Thành công</strong>
        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Đóng"></button>
    </div>
    <div class="toast-body" id="successMessage"></div>
</div>

<!-- Toast cho thông báo lỗi -->
<div class="toast toast-error" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false" style="position: absolute; top: 0; right: 0;">
    <div class="toast-header">
        <strong class="me-auto">Lỗi</strong>
        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Đóng"></button>
    </div>
    <div class="toast-body" id="errorMessage"></div>
</div>
</html>